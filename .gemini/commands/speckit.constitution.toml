description = "대화형 또는 제공된 원칙 입력을 통해 프로젝트 헌법을 생성하거나 업데이트하여 모든 종속된 템플릿이 동기화되도록 합니다."

prompt = """
---
description: 대화형 또는 제공된 원칙 입력을 통해 프로젝트 헌법을 생성하거나 업데이트하여 모든 종속된 템플릿이 동기화되도록 합니다.
handoffs: 
  - label: 사양 작성
    agent: speckit.specify
    prompt: 업데이트된 헌법을 기반으로 기능 사양을 구현합니다. 다음을 구축하고 싶습니다...
---

## 사용자 입력

```text
$ARGUMENTS
```

진행하기 전에 사용자 입력이 비어 있지 않다면 이를 **반드시** 고려해야 합니다.

## 개요

귀하는 `.specify/memory/constitution.md`에 있는 프로젝트 헌법을 업데이트하고 있습니다. 이 파일은 대괄호 안의 자리 표시자 토큰(예: `[PROJECT_NAME]`, `[PRINCIPLE_1_NAME]`)을 포함하는 템플릿입니다. 귀하의 역할은 (a) 구체적인 값을 수집/도출하고, (b) 템플릿을 정밀하게 채우며, (c) 수정 사항을 종속된 모든 산출물에 전파하는 것입니다.

**참고**: `.specify/memory/constitution.md`가 아직 존재하지 않는 경우, 프로젝트 설정 중에 `.specify/templates/constitution-template.md`에서 초기화되었어야 합니다. 만약 누락된 경우 템플릿을 먼저 복사하십시오.

다음 실행 흐름을 따르십시오:

1. `.specify/memory/constitution.md`에 있는 기존 헌법을 로드합니다.
   - `[ALL_CAPS_IDENTIFIER]` 형식의 모든 자리 표시자 토큰을 식별합니다.
   **중요**: 사용자는 템플릿에 사용된 것보다 적거나 많은 원칙을 요구할 수 있습니다. 숫자가 지정된 경우 이를 존중하여 일반 템플릿을 따르되 문서를 적절히 업데이트하십시오.

2. 자리 표시자에 대한 값을 수집/도출합니다:
   - 사용자 입력(대화)에서 값을 제공하는 경우 해당 값을 사용합니다.
   - 그렇지 않은 경우 기존 저장소 컨텍스트(README, 문서, 포함된 이전 헌법 버전)에서 유추합니다.
   - 거버넌스 날짜의 경우: `RATIFICATION_DATE`는 최초 채택 날짜입니다(알 수 없는 경우 묻거나 TODO로 표시). `LAST_AMENDED_DATE`는 오늘 변경 사항이 있는 경우 오늘 날짜로, 그렇지 않으면 이전 날짜를 유지합니다.
   - `CONSTITUTION_VERSION`은 시맨틱 버저닝 규칙에 따라 증가해야 합니다:
     - MAJOR: 하위 호환되지 않는 거버넌스/원칙 삭제 또는 재정의.
     - MINOR: 새로운 원칙/섹션 추가 또는 실질적으로 확장된 가이드.
     - PATCH: 명확화, 문구 수정, 오타 수정, 비시맨틱 개선.
   - 버전 업 유형이 모호한 경우 확정하기 전에 이유를 제시하십시오.

3. 업데이트된 헌법 내용을 초안으로 작성합니다:
   - 모든 자리 표시자를 구체적인 텍스트로 대체합니다 (프로젝트에서 정의하지 않기로 선택하여 의도적으로 유지한 템플릿 슬롯을 제외하고는 대괄호 토큰이 남아서는 안 되며, 남겨두는 경우 명시적으로 정당화해야 함).
   - 헤딩 계층 구조를 유지하고, 주석은 교체된 후에도 명확한 지침을 제공하는 데 도움이 되지 않는다면 제거할 수 있습니다.
   - 각 원칙(Principle) 섹션이 다음을 포함하도록 하십시오: 간결한 이름 라인, 협상 불가능한 규칙을 담은 단락(또는 불렛 리스트), 명확하지 않은 경우 명시적인 근거.
   - 거버넌스(Governance) 섹션에 개정 절차, 버전 관리 정책 및 규정 준수 검토 기대 사항이 나열되어 있는지 확인하십시오.

4. 일관성 전파 체크리스트 (이전 체크리스트를 활성 검증으로 변환):
   - `.specify/templates/plan-template.md`를 읽고 "Constitution Check"나 규칙이 업데이트된 원칙과 일치하는지 확인합니다.
   - 범위/요구 사항 정렬을 위해 `.specify/templates/spec-template.md`를 읽습니다. 헌법이 필수 섹션이나 제약 사항을 추가/삭제한 경우 업데이트합니다.
   - `.specify/templates/tasks-template.md`를 읽고 작업 분류가 신규 또는 삭제된 원칙 기반 작업 유형(예: 관측 가능성, 버전 관리, 테스트 규율)을 반영하는지 확인합니다.
   - `.specify/templates/commands/*.md`에 있는 각 명령 파일(이 파일 포함)을 읽어 범용적인 안내가 필요할 때 특정 에이전트 이름(예: CLAUDE)과 같은 오래된 참조가 남아 있지 않은지 확인합니다.
   - 런타임 지침 문서(예: `README.md`, `docs/quickstart.md` 또는 에이전트 전용 지침 파일이 있는 경우)를 읽습니다. 변경된 원칙에 대한 참조를 업데이트합니다.

5. 동기화 영향 보고서(Sync Impact Report) 생성 (업데이트 후 헌법 파일 맨 위에 HTML 주석으로 추가):
   - 버전 변경: 이전 → 이후
   - 수정된 원칙 목록 (명칭 변경 시 이전 제목 → 새 제목)
   - 추가된 섹션
   - 삭제된 섹션
   - 업데이트가 필요한 템플릿 (✅ 업데이트됨 / ⚠ 보류 중) 및 파일 경로
   - 의도적으로 보류된 자리 표시자가 있는 경우 후속 TODO 항목

6. 최종 출력 전 검증:
   - 설명되지 않은 대괄호 토큰이 남아 있지 않아야 함.
   - 버전 라인이 보고서와 일치해야 함.
   - 날짜는 ISO 형식(YYYY-MM-DD)이어야 함.
   - 원칙은 선언적이고 테스트 가능하며 모호한 언어("~해야 함(should)" → 적절한 경우 MUST/SHOULD 근거로 대체)가 없어야 함.

7. 완성된 헌법을 `.specify/memory/constitution.md`에 다시 씁니다(덮어쓰기).

8. 다음 내용을 포함하여 사용자에게 최종 요약을 출력합니다:
   - 새 버전 및 버전 업 근거.
   - 수동 후속 작업이 필요한 파일.
   - 권장 커밋 메시지 (예: `docs: vX.Y.Z로 헌법 개정 (원칙 추가 + 거버넌스 업데이트)`).

서식 및 스타일 요구 사항:
- 템플릿과 동일한 마크다운 헤딩을 사용하십시오 (수준을 높이거나 낮추지 마십시오).
- 가독성을 위해 긴 근거 문장은 줄을 바꿉니다 (가급적 100자 미만) 하지만 어색한 중단이 생기도록 강제하지는 마십시오.
- 섹션 사이에 한 줄의 공백을 유지하십시오.
- 행 끝의 공백을 피하십시오.

사용자가 부분적인 업데이트(예: 단 하나의 원칙 수정)를 제공하더라도 검증 및 버전 결정 단계를 수행하십시오.

중요한 정보(예: 최초 비준일)를 정말 알 수 없는 경우 `TODO(<FIELD_NAME>): 설명`을 삽입하고 동기화 영향 보고서의 보류 항목에 포함하십시오.

새 템플릿을 생성하지 마십시오. 항상 기존 `.specify/memory/constitution.md` 파일에서 작업하십시오.
"""
