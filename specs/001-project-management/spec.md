# 기능 사양: Redmine 프로젝트 관리 (Project Management)

**기능 브랜치**: `001-project-management`  
**생성일**: 2026-02-12  
**상태**: 초안(Draft)  
**입력**: 사용자 설명: "Redmine REST API를 기반으로 프로젝트 관리(Project Management) 기능을 정의하라. 1. 프로젝트 목록 조회: 전체 프로젝트를 조회하거나, 상태(활성/종료)에 따라 필터링하여 검색하는 기능을 구현한다. 2. 프로젝트 상세 정보: 프로젝트 식별자(Slug)를 사용하여 설명, 홈페이지, 상위/하위 프로젝트 계층 구조 등 상세 정보를 조회한다. 3. 생성 및 수정: AI가 신규 프로젝트를 생성하거나 기존 프로젝트의 기본 정보를 수정하는 도구를 구현한다. (주의: 반드시 사용자 승인이 필요함) 4. 멤버 관리: 특정 프로젝트에 할당된 사용자 목록과 역할을 조회하여, 이슈를 할당할 수 있는 대상을 파악한다."

## 사용자 시나리오 및 테스트 *(필수)*

## Clarifications

### Session 2026-02-12
- Q: 사용자 승인 메커니즘 → A: 1단계: 변경 요약 및 '승인 토큰' 반환 -> 2단계: 사용자가 토큰과 함께 승인 요청 시 실제 반영하는 2단계 프로세스를 따름.
- Q: 프로젝트 멤버 역할(Role)의 범위 → A: 역할의 ID와 이름(Display Name)만 제공함. 상세 권한(Permissions)은 포함하지 않음.
- Q: Redmine-Django API 인증 방식 → A: OAuth를 사용하며, MCP Server가 Client에게 전용 토큰을 발급하고 실제 Redmine 액세스 토큰은 Server에서 매핑 관리함.
- Q: 대규모 데이터 조회 페이지네이션 → A: 첫 페이지 데이터와 함께 '다음 페이지 토큰'을 반환하는 증분 조회 방식을 사용함.
- Q: 프로젝트 삭제 기능 포함 여부 → A: 물리적 삭제 기능은 사양에서 제외함. 필요한 경우 사용자가 직접 웹 UI를 통해 수행해야 함.

### 사용자 스토리 1 - 프로젝트 현황 파악 및 필터링 (우선순위: P1)

사용자는 Redmine에 등록된 전체 프로젝트 목록을 확인하고, 현재 활성화된 프로젝트나 종료된 프로젝트만 따로 모아볼 수 있습니다.

**우선순위 이유**: 프로젝트 관리의 가장 기본이 되는 기능으로, 다른 모든 프로젝트 관련 작업의 시작점입니다.

**독립 테스트**: 프로젝트 목록 조회 도구를 호출하여 필터링 조건에 맞는 결과가 정확히 반환되는지 확인함으로써 테스트할 수 있습니다.

**수락 시나리오(Acceptance Scenarios)**:

1. **Given** 사용자가 전체 프로젝트 목록을 요청함, **When** 필터 없이 조회함, **Then** 기본적으로 모든 활성(Active) 프로젝트 목록이 반환됨.
2. **Given** 사용자가 종료된 프로젝트 조회를 요청함, **When** 상태 필터를 '종료(Closed)'로 설정하여 조회함, **Then** 종료된 프로젝트만 결과에 포함됨.

---

### 사용자 스토리 2 - 프로젝트 상세 정보 및 계층 구조 확인 (우선순위: P1)

사용자는 특정 프로젝트의 식별자(Slug)를 사용하여 해당 프로젝트의 설명, 홈페이지, 그리고 상위 프로젝트와 하위 프로젝트들이 어떻게 연결되어 있는지 계층 구조를 상세히 확인할 수 있습니다.

**우선순위 이유**: 프로젝트의 맥락을 이해하고 관련 이슈들이 어디에 속해있는지 파악하는 데 필수적입니다.

**독립 테스트**: 특정 프로젝트 식별자로 상세 조회를 수행하여 설명, 홈페이지, 상/하위 프로젝트 정보가 누락 없이 출력되는지 확인함으로써 테스트할 수 있습니다.

**수락 시나리오**:

1. **Given** 유효한 프로젝트 식별자가 주어짐, **When** 상세 조회를 요청함, **Then** 해당 프로젝트의 설명, 홈페이지, 상위 프로젝트 이름 및 하위 프로젝트 목록이 반환됨.

---

### 사용자 스토리 3 - 프로젝트 멤버 및 역할 조회 (우선순위: P2)

사용자는 특정 프로젝트에 참여하고 있는 멤버 목록과 그들의 역할을 조회하여, 이슈를 누구에게 할당할 수 있는지 또는 특정 작업의 권한이 누구에게 있는지 파악할 수 있습니다.

**우선순위 이유**: 이슈 관리 및 팀 협업을 위해 담당자를 선정하는 데 필요한 정보를 제공합니다.

**독립 테스트**: 특정 프로젝트의 멤버 조회를 수행하여 사용자 이름과 할당된 역할(Role) 목록이 정확히 매칭되어 출력되는지 확인함으로써 테스트할 수 있습니다.

**수락 시나리오**:

1. **Given** 프로젝트 식별자가 주어짐, **When** 멤버 목록 조회를 요청함, **Then** 해당 프로젝트에 할당된 사용자들의 이름과 각각의 역할(예: Manager, Developer 등) 정보가 반환됨.

---

### 사용자 스토리 4 - 프로젝트 생성 및 정보 수정 (우선순위: P2)

AI 에이전트가 사용자의 요청에 따라 새로운 프로젝트를 생성하거나 기존 프로젝트의 이름, 설명 등 기본 정보를 수정합니다. 이 과정에서 반드시 사용자의 최종 승인을 거쳐야 합니다.

**우선순위 이유**: 관리 작업을 자동화하여 효율성을 높이되, 데이터 변경에 대한 안전성을 보장합니다.

**독립 테스트**: 신규 프로젝트 생성 요청 또는 수정 요청 시 시스템이 승인 단계를 거치는지 확인하고, 승인 후 Redmine에 실제 반영되는지 확인함으로써 테스트할 수 있습니다.

**수락 시나리오**:

1. **Given** 신규 프로젝트 정보가 입력됨, **When** 생성 도구를 호출함, **Then** 사용자에게 변경 사항을 보여주고 승인을 요청하며, 승인 시 프로젝트가 생성됨.
2. **Given** 기존 프로젝트 식별자와 수정할 정보가 주어짐, **When** 수정 도구를 호출함, **Then** Redmine API가 허용하는 모든 필드(이름, 설명, 홈페이지, 식별자, 공개 여부, 상위 프로젝트, 상태 등)에 대해 사용자 승인 후 정보가 업데이트됨.

### 예외 케이스(Edge Cases)

- 존재하지 않는 프로젝트 식별자(Slug)로 조회를 시도할 경우, 시스템은 사용자 친화적인 에러 메시지를 반환해야 합니다.
- 프로젝트 생성 시 이미 존재하는 식별자를 사용할 경우, 중복 에러를 명확히 안내해야 합니다.
- 상위 프로젝트 설정 시 권한이 없거나 순환 참조가 발생하는 경우, 시스템은 Redmine API의 에러 메시지를 사용자에게 그대로 전달하여 문제 원인을 파악할 수 있도록 합니다.

## 요구 사항 *(필수)*

### 기능적 요구 사항

- **FR-001**: 시스템은 OAuth 인증을 지원해야 하며, MCP Server는 Client에게 개별 토큰을 발급하고 실제 Redmine-Django API 토큰은 Server에서 안전하게 매핑 관리해야 함.
- **FR-002**: 시스템은 API의 필터링 기능을 활용하여 프로젝트 상태(Active, Closed) 및 키워드에 따른 검색 기능을 제공해야 함.
- **FR-003**: 시스템은 식별자를 기반으로 프로젝트의 상세 정보(설명, 홈페이지, 계층 구조)를 조회할 수 있어야 함.
- **FR-004**: 시스템은 증분 조회 방식(offset/limit 또는 cursor)을 적용하여 대규모 데이터를 효율적으로 조회해야 하며, 추가 조회가 가능한 경우 다음 페이지 정보를 포함해야 함.
- **FR-005**: AI 에이전트는 프로젝트 생성/수정 전 변경 사항을 요약하고 '승인 토큰'을 발급해야 하며, 사용자가 해당 토큰을 사용하여 명시적으로 승인 요청을 한 경우에만 최종 작업을 수행해야 함.
- **FR-006**: 시스템은 프로젝트 간의 상/하위 계층 관계를 식별하고 정보를 제공해야 함.

### 주요 엔티티 *(기능에 데이터가 포함된 경우 포함)*

- **Project**: `name` (필수), `identifier` (필수, 슬러그), `description`, `homepage`, `is_public` 속성을 가짐.
- **ProjectHierarchy**: `parent_id` (쓰기 전용)를 통해 부모-자식 관계 설정.
- **Member**: 프로젝트 멤버십 정보를 포함하며, 사용자 ID, 이름 및 할당된 역할(Role ID, Name) 목록을 포함함.
- **Role**: 멤버에게 부여된 역할 정보로 `id`와 `name`만 포함하며, 세부 권한 목록은 제외함.
- **Pagination**: `count`, `next`, `previous`를 포함한 페이지네이션 구조.

## 성공 기준 *(필수)*

### 측정 가능한 결과

- **SC-001**: 사용자가 특정 프로젝트의 모든 멤버와 역할을 조회하는 데 걸리는 시간이 3초 이내여야 함.
- **SC-002**: 프로젝트 목록 필터링(활성/종료) 결과가 Redmine 웹 인터페이스의 결과와 100% 일치해야 함.
- **SC-003**: AI가 생성/수정한 모든 프로젝트 작업에 대해 100% 사용자 승인 기록이 존재해야 함.
- **SC-004**: 상/하위 프로젝트 계층 구조가 누락 없이 트리 형태로 파악 가능해야 함.
